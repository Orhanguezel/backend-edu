### **ğŸ“Œ Mongoose'da "Unter Dokumente" (Alt Belgeler) Nedir?**

Mongoose'da **alt belgeler (Subdocuments)**, bir **belge (document) iÃ§inde baÅŸka bir belgeyi saklamamÄ±zÄ±** saÄŸlar.  
Bu yapÄ± **MongoDB'nin iÃ§ iÃ§e geÃ§miÅŸ (nested) veri modelini desteklemesi** sayesinde mÃ¼mkÃ¼n olur.  

---

## **âœ… Alt Belgelerin KullanÄ±m SenaryolarÄ±**
Alt belgeler **ÅŸu durumlarda kullanÄ±ÅŸlÄ±dÄ±r:**
1ï¸âƒ£ **Bir belge iÃ§inde iliÅŸkili veriler saklanacaksa**  
   - Ã–rneÄŸin, **bir kullanÄ±cÄ±nÄ±n adres bilgileri** tek bir belge iÃ§inde saklanabilir.  
2ï¸âƒ£ **Tekrarlayan veri yapÄ±larÄ± varsa**  
   - Ã–rneÄŸin, **bir blog gÃ¶nderisinin yorumlarÄ± (comments)**.  
3ï¸âƒ£ **Ä°liÅŸkili veriler iÃ§in ayrÄ± koleksiyon kullanmaya gerek yoksa**  
   - EÄŸer bir veri, sadece **ana belgeyle birlikte kullanÄ±lacaksa**, alt belge olarak saklanabilir.  

---

## **âœ… Alt Belgeler ile Modelleme**
### **1ï¸âƒ£ Temel Alt Belge KullanÄ±mÄ±**
**Ã–rnek:** Bir **kullanÄ±cÄ± (User) modelinde**, **adres bilgileri (address)** bir alt belge olarak saklanabilir.
```javascript
const mongoose = require("mongoose");

const addressSchema = new mongoose.Schema({
  street: String,
  city: String,
  zipCode: Number
});

const userSchema = new mongoose.Schema({
  name: { type: String, required: true },
  email: { type: String, required: true, unique: true },
  address: addressSchema  // âœ… Alt belge (Subdocument)
});

const User = mongoose.model("User", userSchema);
```
âœ… **`address` bir alt belge olarak tanÄ±mlandÄ±.**  
âœ… **Ana koleksiyon iÃ§inde gÃ¶mÃ¼lÃ¼ bir yapÄ± olarak saklanacak.**  

ğŸ“Œ **Ã–rnek KullanÄ±m:**
```javascript
const newUser = new User({
  name: "Ali Veli",
  email: "ali@example.com",
  address: {
    street: "AtatÃ¼rk Caddesi",
    city: "Ä°stanbul",
    zipCode: 34000
  }
});

await newUser.save();
console.log("âœ… KullanÄ±cÄ± kaydedildi:", newUser);
```
ğŸ“Œ **VeritabanÄ±na kaydedildiÄŸinde aÅŸaÄŸÄ±daki gibi gÃ¶rÃ¼necektir:**
```json
{
  "_id": "6609abcd123456",
  "name": "Ali Veli",
  "email": "ali@example.com",
  "address": {
    "street": "AtatÃ¼rk Caddesi",
    "city": "Ä°stanbul",
    "zipCode": 34000
  }
}
```

---

### **2ï¸âƒ£ Dizi (Array) Ä°Ã§inde Alt Belgeler**
**Ã–rnek:** Bir **blog gÃ¶nderisinin yorumlarÄ± (comments)** alt belgeler olarak saklanabilir.
```javascript
const commentSchema = new mongoose.Schema({
  text: String,
  author: String,
  date: { type: Date, default: Date.now }
});

const postSchema = new mongoose.Schema({
  title: String,
  content: String,
  comments: [commentSchema]  // âœ… Dizi iÃ§inde alt belgeler
});

const Post = mongoose.model("Post", postSchema);
```
âœ… **`comments` bir dizi (array) iÃ§inde saklanÄ±yor.**  
âœ… **Her yorum (`comment`) kendi iÃ§inde `text`, `author`, `date` iÃ§eriyor.**

ğŸ“Œ **Ã–rnek KullanÄ±m:**
```javascript
const newPost = new Post({
  title: "Mongoose ile Alt Belgeler",
  content: "Alt belgeleri nasÄ±l kullanacaÄŸÄ±mÄ±zÄ± Ã¶ÄŸreniyoruz...",
  comments: [
    { text: "Ã‡ok faydalÄ±!", author: "Mehmet" },
    { text: "TeÅŸekkÃ¼rler!", author: "AyÅŸe" }
  ]
});

await newPost.save();
console.log("âœ… Blog gÃ¶nderisi kaydedildi:", newPost);
```
ğŸ“Œ **VeritabanÄ±nda ÅŸu ÅŸekilde saklanÄ±r:**
```json
{
  "_id": "6610abcd123456",
  "title": "Mongoose ile Alt Belgeler",
  "content": "Alt belgeleri nasÄ±l kullanacaÄŸÄ±mÄ±zÄ± Ã¶ÄŸreniyoruz...",
  "comments": [
    {
      "text": "Ã‡ok faydalÄ±!",
      "author": "Mehmet",
      "date": "2024-03-17T12:00:00Z"
    },
    {
      "text": "TeÅŸekkÃ¼rler!",
      "author": "AyÅŸe",
      "date": "2024-03-17T12:01:00Z"
    }
  ]
}
```

---

### **3ï¸âƒ£ Alt Belgelerde DoÄŸrulama (Validation)**
Alt belgeler iÃ§in de **doÄŸrulama (validation) kurallarÄ±** ekleyebiliriz.
```javascript
const reviewSchema = new mongoose.Schema({
  rating: { type: Number, min: 1, max: 5, required: true }, // 1 ile 5 arasÄ±nda olmalÄ±
  comment: { type: String, required: true },
  date: { type: Date, default: Date.now }
});

const productSchema = new mongoose.Schema({
  name: { type: String, required: true },
  price: { type: Number, required: true, min: 0 },
  reviews: [reviewSchema]  // âœ… Alt belge doÄŸrulamasÄ± eklendi
});

const Product = mongoose.model("Product", productSchema);
```
âœ… **`rating` en az `1`, en fazla `5` olmalÄ±.**  
âœ… **`comment` zorunlu (`required: true`).**  
âœ… **`date` otomatik olarak ekleniyor.**

ğŸ“Œ **Ã–rnek KullanÄ±m:**
```javascript
const newProduct = new Product({
  name: "Laptop",
  price: 2500,
  reviews: [
    { rating: 5, comment: "Harika bir Ã¼rÃ¼n!" },
    { rating: 3, comment: "Ä°dare eder." }
  ]
});

await newProduct.save();
console.log("âœ… ÃœrÃ¼n kaydedildi:", newProduct);
```

---

## **ğŸ“Œ Alt Belgeler Ãœzerinde CRUD Ä°ÅŸlemleri**
### **âœ… Alt Belge Ekleme**
```javascript
const post = await Post.findById(postId);
post.comments.push({ text: "Yeni yorum", author: "Zeynep" });
await post.save();
console.log("âœ… Yeni yorum eklendi!");
```

### **âœ… Alt Belge GÃ¼ncelleme**
```javascript
const post = await Post.findById(postId);
const comment = post.comments.id(commentId);
comment.text = "GÃ¼ncellenmiÅŸ yorum";
await post.save();
console.log("âœ… Yorum gÃ¼ncellendi!");
```

### **âœ… Alt Belge Silme**
```javascript
const post = await Post.findById(postId);
post.comments.id(commentId).remove();
await post.save();
console.log("âœ… Yorum silindi!");
```

---

## **ğŸ“Œ Alt Belgeler ve ReferanslÄ± Belgeler ArasÄ±ndaki Fark**
| **Alt Belgeler (Subdocuments)** | **ReferanslÄ± Belgeler (Referenced Documents)** |
|---------------------------------|--------------------------------|
| **Ana belge iÃ§inde saklanÄ±r.** | **AyrÄ± bir koleksiyonda saklanÄ±r.** |
| **Daha hÄ±zlÄ± okunur, ancak bÃ¼yÃ¼k veri iÃ§in yavaÅŸ olabilir.** | **Daha esnektir ve bÃ¼yÃ¼k veri iÃ§in uygundur.** |
| **Tek bir belge ile birlikte yÃ¼klenir.** | **Ä°liÅŸkili veriler `populate()` ile Ã§ekilir.** |
| Ã–rnek: **Bir kullanÄ±cÄ±nÄ±n adres bilgileri** | Ã–rnek: **Bir kullanÄ±cÄ±nÄ±n yazdÄ±ÄŸÄ± gÃ¶nderiler** |

---

## **ğŸ“Œ Ã–zet**
âœ… **Alt belgeler (Subdocuments), Mongoose'da iÃ§ iÃ§e geÃ§miÅŸ veri yapÄ±larÄ± oluÅŸturmak iÃ§in kullanÄ±lÄ±r.**  
âœ… **Bir belge iÃ§inde iliÅŸkili veriler tutulabilir (Ã¶rneÄŸin, kullanÄ±cÄ±nÄ±n adres bilgileri veya bir gÃ¶nderinin yorumlarÄ±).**  
âœ… **Diziler iÃ§inde alt belgeler kullanÄ±labilir ve doÄŸrulamalar eklenebilir.**  
âœ… **CRUD iÅŸlemleri doÄŸrudan ana belge Ã¼zerinden yapÄ±lÄ±r.**  

ğŸš€ **Alt belgeler, iliÅŸkili verileri saklamak iÃ§in kullanÄ±ÅŸlÄ± ve performanslÄ± bir yÃ¶ntemdir!** ğŸš€