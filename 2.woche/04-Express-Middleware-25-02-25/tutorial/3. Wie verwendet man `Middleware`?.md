# **3ï¸âƒ£ Middleware NasÄ±l KullanÄ±lÄ±r? (Wie verwendet man Middleware?)**  

Middlewareâ€™i **Express.js iÃ§inde nasÄ±l kullanacaÄŸÄ±mÄ±zÄ±** detaylÄ±ca inceleyelim. Expressâ€™te middleware **3 farklÄ± ÅŸekilde kullanÄ±labilir**:  

1. **Global (Uygulama Seviyesinde) Middleware** â€“ TÃ¼m rotalar iÃ§in Ã§alÄ±ÅŸÄ±r.  
2. **Route-Specific (Belirli Rotalarda KullanÄ±lan) Middleware** â€“ Sadece belirli bir rota iÃ§in Ã§alÄ±ÅŸÄ±r.  
3. **Error-Handling (Hata YÃ¶netimi) Middleware** â€“ HatalarÄ± yakalar ve Ã¶zel iÅŸlem yapar.  

ğŸš€ **BaÅŸlayalÄ±m!**

---

## **1ï¸âƒ£ Global (Uygulama Seviyesinde) Middleware KullanÄ±mÄ±**  
ğŸ“Œ **Global middleware, Express uygulamasÄ±ndaki tÃ¼m HTTP isteklerinde Ã§alÄ±ÅŸÄ±r.**  

âœ… **Ã–rnek: Ä°stekleri Konsola Loglayan Middleware**
```js
import express from "express";

const app = express();

// Middleware: Gelen her isteÄŸi loglar
app.use((req, res, next) => {
  console.log(`[${new Date().toISOString()}] ${req.method} ${req.url}`);
  next(); // Bir sonraki aÅŸamaya geÃ§
});

app.get("/", (req, res) => {
  res.send("Ana Sayfa");
});

app.get("/about", (req, res) => {
  res.send("HakkÄ±mÄ±zda SayfasÄ±");
});

app.listen(5000, () => console.log("Server 5000 portunda Ã§alÄ±ÅŸÄ±yor"));
```
ğŸ“Œ **Ne yapar?**  
âœ” **Her gelen isteÄŸi loglar.**  
âœ” **TÃ¼m rotalarda otomatik Ã§alÄ±ÅŸÄ±r.**  
âœ” **`next()` Ã§aÄŸrÄ±ldÄ±ÄŸÄ± iÃ§in istek iÅŸleme devam eder.**  

---

## **2ï¸âƒ£ Route-Specific Middleware KullanÄ±mÄ±**
ğŸ“Œ **Sadece belirli bir rota iÃ§in middleware Ã§alÄ±ÅŸtÄ±rmak istiyorsak, middlewareâ€™i doÄŸrudan rotaya ekleriz.**  

âœ… **Ã–rnek: Belirli Bir Rota Ä°Ã§in Kimlik DoÄŸrulama Middlewareâ€™i**  
```js
const authMiddleware = (req, res, next) => {
  const token = req.headers["authorization"];
  if (!token) {
    return res.status(401).json({ message: "Yetkisiz giriÅŸ!" });
  }
  next(); // Token geÃ§erliyse devam et
};

// Sadece /dashboard rotasÄ±nda Ã§alÄ±ÅŸÄ±r
app.get("/dashboard", authMiddleware, (req, res) => {
  res.send("HoÅŸgeldiniz, yetkiniz var!");
});
```
ğŸ“Œ **Ne yapar?**  
âœ” **Sadece `/dashboard` rotasÄ±na uygulanÄ±r.**  
âœ” **Yetkilendirme kontrolÃ¼ yapar, token yoksa 401 hatasÄ± dÃ¶ner.**  
âœ” **DiÄŸer rotalar etkilenmez.**  

---

## **3ï¸âƒ£ Error-Handling (Hata YÃ¶netimi) Middleware KullanÄ±mÄ±**
ğŸ“Œ **Expressâ€™te hata yÃ¶netimi iÃ§in Ã¶zel middleware tanÄ±mlayabiliriz.**  

âœ… **Ã–rnek: Global Hata YÃ¶netimi Middlewareâ€™i**
```js
app.use((err, req, res, next) => {
  console.error("Hata:", err.message);
  res.status(500).json({ message: "Sunucu HatasÄ±!" });
});
```
ğŸ“Œ **Ne yapar?**  
âœ” **Sunucuda bir hata olursa Express bunu otomatik olarak bu middleware'e yÃ¶nlendirir.**  
âœ” **KullanÄ±cÄ±ya 500 hatasÄ± dÃ¶ndÃ¼rÃ¼r.**  
âœ” **`next(err)` ÅŸeklinde Ã§aÄŸrÄ±larak hatalar buraya yÃ¶nlendirilir.**  

---

## **4ï¸âƒ£ Built-in (Dahili) Middleware KullanÄ±mÄ±**
Express, bazÄ± hazÄ±r middlewareâ€™leri **built-in olarak** saÄŸlar.  

### **ğŸ“Œ `express.json()` Middlewareâ€™i**
ğŸ“Œ **JSON formatÄ±ndaki verileri iÅŸlememizi saÄŸlar.**  
```js
app.use(express.json()); // JSON verilerini iÅŸle
```
âœ… **Bu middleware olmadan, `req.body` kullanamazdÄ±k.**  

---

## **Ã–zet: Middleware NasÄ±l KullanÄ±lÄ±r?**
âœ” **Global Middleware:** `app.use(middleware)` â†’ TÃ¼m isteklerde Ã§alÄ±ÅŸÄ±r.  
âœ” **Route-Specific Middleware:** `app.get("/path", middleware, controller)` â†’ Sadece belirli bir rotada Ã§alÄ±ÅŸÄ±r.  
âœ” **Error Middleware:** `app.use((err, req, res, next) => {...})` â†’ HatalarÄ± yÃ¶netir.  
âœ” **Built-in Middleware:** `express.json()` gibi hazÄ±r middlewareâ€™leri kullanabiliriz.  

ğŸ“Œ **Åimdi Middleware TÃ¼rlerini DetaylÄ±ca Ä°nceleyelim!** ğŸš€