# **ğŸ“Œ 6. Sunucu JSON Verisini NasÄ±l Anlar? (`express.json()`)**

Bir **REST API**, istemciden gelen verileri iÅŸleyebilmek iÃ§in **JSON formatÄ±nÄ± anlamalÄ±dÄ±r**.  
ğŸ“Œ **Express.js, gelen JSON verisini anlayabilmesi iÃ§in `express.json()` middlewareâ€™ini kullanÄ±r.**  

---

## **ğŸš€ Express.js JSON Verisini NasÄ±l Anlar?**
Normalde bir **Express.js sunucusu**, gelen verileri **doÄŸrudan okuyamaz**.  
EÄŸer **`express.json()`** kullanÄ±lmazsa, **JSON verisi `undefined` olarak gelir.**  

ğŸ“Œ **Ã–rnek:**  

ğŸš¨ **HatalÄ± Kod (express.json() Olmadan)**
```javascript
import express from "express";

const app = express();
const port = 3001;

app.post("/data", (req, res) => {
    console.log(req.body); // âŒ req.body undefined olacaktÄ±r!
    res.send("Data received!");
});

app.listen(port, () => console.log(`Server running on port ${port}`));
```
âœ… **Test Et (JSON GÃ¶nderelim):**
```bash
curl -X POST http://localhost:3001/data \
     -H "Content-Type: application/json" \
     -d '{"name": "Ali", "email": "ali@example.com"}'
```
âŒ **Ã‡Ä±ktÄ±:**
```bash
undefined
```
ğŸ“Œ **Ã‡Ã¼nkÃ¼ Express, JSON verisini otomatik olarak iÅŸleyemez!**  

---

## **ğŸ“Œ 1ï¸âƒ£ `express.json()` KullanÄ±mÄ±**
Bunu dÃ¼zeltmek iÃ§in **`express.json()` middlewareâ€™ini** eklememiz gerekir.  
Bu middleware, gelen **JSON verisini otomatik olarak ayrÄ±ÅŸtÄ±rÄ±r (parse eder).**  

### **âœ… DoÄŸru KullanÄ±m (`express.json()` ile)**
```javascript
import express from "express";

const app = express();
const port = 3001;

app.use(express.json()); // ğŸ“Œ JSON verisini ayrÄ±ÅŸtÄ±rmayÄ± (parse etmeyi) aktif hale getirir!

app.post("/data", (req, res) => {
    console.log(req.body); // âœ… ArtÄ±k JSON verisini okuyabilir!
    res.json({ message: "Data received successfully!", data: req.body });
});

app.listen(port, () => console.log(`Server running on port ${port}`));
```

âœ… **Test Et (JSON GÃ¶nderelim):**
```bash
curl -X POST http://localhost:3001/data \
     -H "Content-Type: application/json" \
     -d '{"name": "Ali", "email": "ali@example.com"}'
```
âœ… **YanÄ±t:**
```json
{
  "message": "Data received successfully!",
  "data": {
    "name": "Ali",
    "email": "ali@example.com"
  }
}
```
ğŸ“Œ **Sunucu artÄ±k gelen JSON verisini anlayabiliyor!**  

---

## **ğŸ“Œ 2ï¸âƒ£ `express.urlencoded()` KullanÄ±mÄ±**
BazÄ± durumlarda **form verileri (`x-www-form-urlencoded`)** de iÅŸlenmesi gerekebilir.  
Bunun iÃ§in **`express.urlencoded({ extended: true })`** kullanÄ±labilir.

ğŸ“Œ **Ã–rnek:**  
```javascript
app.use(express.urlencoded({ extended: true }));
```
Bu sayede **HTML formlarÄ±ndan gelen verileri de Express sunucusu anlayabilir.**  

âœ… **Form Verisini Test Etmek Ä°Ã§in:**
```bash
curl -X POST http://localhost:3001/data \
     -H "Content-Type: application/x-www-form-urlencoded" \
     -d "name=Ali&email=ali@example.com"
```
âœ… **YanÄ±t:**
```json
{
  "message": "Data received successfully!",
  "data": {
    "name": "Ali",
    "email": "ali@example.com"
  }
}
```
ğŸ“Œ **Hem JSON hem de Form verileri iÅŸlenebilir hale geldi!**  

---

## **ğŸ“Œ 3ï¸âƒ£ `body-parser` KullanÄ±mÄ± (GÃ¼nÃ¼mÃ¼zde Gereksiz)**
ğŸ“Œ **Ã–nceden Expressâ€™in JSON verisini anlamasÄ± iÃ§in `body-parser` paketi gerekiyordu.**  
Ancak **Express 4.16.0** ve sonrasÄ±nda **`express.json()` ve `express.urlencoded()`** **yerleÅŸik hale getirildi**.

ğŸš¨ **ArtÄ±k `body-parser` yÃ¼klemeye gerek yoktur!**
```javascript
// Eski yÃ¶ntem (GEREKSÄ°Z)
import bodyParser from "body-parser";
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));
```
âœ… **Åu an doÄŸru yÃ¶ntem:**
```javascript
app.use(express.json());
app.use(express.urlencoded({ extended: true }));
```

---

## **ğŸ“Œ 4ï¸âƒ£ JSON Veri FormatÄ± DoÄŸru OlmalÄ±**
ğŸ“Œ **Sunucunun JSON'u anlamasÄ± iÃ§in istemciden gelen verinin formatÄ± doÄŸru olmalÄ±dÄ±r.**  

ğŸš¨ **YanlÄ±ÅŸ JSON FormatÄ± (Hata Verir)**
```json
{ "name": "Ali", "email": "ali@example.com", }  // Son virgÃ¼l hata oluÅŸturur!
```
âŒ **Hata:** `Unexpected token } in JSON`  

âœ… **DoÄŸru JSON FormatÄ±**
```json
{ "name": "Ali", "email": "ali@example.com" }
```
ğŸ“Œ **JSON hatalarÄ±nÄ± engellemek iÃ§in Postman veya JSON validator araÃ§larÄ± kullanÄ±labilir.**  

---

## **ğŸ“Œ Ã–zet**
| **Konu** | **AÃ§Ä±klama** |
|----------|-------------|
| **`express.json()`** | Sunucunun gelen JSON verisini anlamasÄ±nÄ± saÄŸlar. |
| **`express.urlencoded()`** | Form verilerini ayrÄ±ÅŸtÄ±rÄ±r (parse eder). |
| **JSON HatasÄ±** | YanlÄ±ÅŸ formatlÄ± JSON, sunucu tarafÄ±ndan iÅŸlenemez. |
| **`body-parser` Gerekli mi?** | HayÄ±r, Expressâ€™in iÃ§ine dahil edildi. |

ğŸš€ **Sonraki Konu:** **Postman ve Insomnia kullanarak APIâ€™leri test etmek!** ğŸ¯  
Bu araÃ§lar, **cURL yerine gÃ¶rsel olarak istek yapmamÄ±zÄ± saÄŸlar.**  
Bunun hakkÄ±nda konuÅŸalÄ±m mÄ±? ğŸ˜Š